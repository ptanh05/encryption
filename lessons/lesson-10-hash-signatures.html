<!doctype html>
<html lang="vi">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>B√†i 10: Hash Functions & Digital Signatures</title>
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/fontello.css">
    <link rel="stylesheet" href="../css/design-system.css">
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/lesson-styles.css">
    <link rel="stylesheet" href="../css/animations.css">
    <link rel="stylesheet" href="../css/responsive.css">
</head>
<body class="lesson" data-lesson="10">
    <nav class="lesson-nav">
        <a href="../index.html">‚Üê V·ªÅ trang ch·ªß</a>
        <div class="lesson-progress-bar">
            <div class="progress-fill"></div>
        </div>
    </nav>

    <header class="lesson-header">
        <h1>B√†i 10: Hash Functions & Digital Signatures</h1>
        <p class="lesson-meta">
            <span>‚è±Ô∏è Th·ªùi gian: ~30 ph√∫t</span>
            <span>‚≠ê ƒê·ªô kh√≥: Trung b√¨nh</span>
            <span>üìö Module 4: M√£ h√≥a Hi·ªán ƒë·∫°i</span>
        </p>
    </header>

    <main class="lesson-content">
        <section class="theory">
            <h2>üìñ L√Ω thuy·∫øt</h2>
            
            <h3>Hash Functions (H√†m bƒÉm)</h3>
            <p>
                <strong>Hash Function</strong> l√† h√†m m·ªôt chi·ªÅu chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu c√≥ ƒë·ªô d√†i b·∫•t k·ª≥ 
                th√†nh m·ªôt chu·ªói c√≥ ƒë·ªô d√†i c·ªë ƒë·ªãnh (hash value).
            </p>

            <h4>T√≠nh ch·∫•t c·ªßa Hash Function t·ªët:</h4>
            <ul>
                <li><strong>Deterministic:</strong> C√πng input ‚Üí c√πng output</li>
                <li><strong>Fast computation:</strong> T√≠nh to√°n nhanh</li>
                <li><strong>Pre-image resistance:</strong> Kh√≥ t√¨m input t·ª´ output</li>
                <li><strong>Collision resistance:</strong> Kh√≥ t√¨m 2 input c√≥ c√πng hash</li>
            </ul>

            <h3>C√°c thu·∫≠t to√°n Hash ph·ªï bi·∫øn</h3>
            <ul>
                <li><strong>MD5:</strong> 128-bit, ƒë√£ b·ªã ph√° (kh√¥ng an to√†n)</li>
                <li><strong>SHA-1:</strong> 160-bit, ƒë√£ b·ªã ph√° (kh√¥ng an to√†n)</li>
                <li><strong>SHA-256:</strong> 256-bit, an to√†n (d√πng trong Bitcoin)</li>
                <li><strong>SHA-512:</strong> 512-bit, an to√†n</li>
            </ul>

            <h3>·ª®ng d·ª•ng c·ªßa Hash</h3>
            <ul>
                <li><strong>Password storage:</strong> L∆∞u hash thay v√¨ password g·ªëc</li>
                <li><strong>Data integrity:</strong> Ki·ªÉm tra file c√≥ b·ªã thay ƒë·ªïi kh√¥ng</li>
                <li><strong>Digital signatures:</strong> T·∫°o ch·ªØ k√Ω s·ªë</li>
                <li><strong>Blockchain:</strong> T·∫°o block hash</li>
            </ul>

            <h3>Digital Signatures (Ch·ªØ k√Ω s·ªë)</h3>
            <p>
                <strong>Digital Signature</strong> l√† ph∆∞∆°ng ph√°p x√°c th·ª±c danh t√≠nh v√† ƒë·∫£m b·∫£o t√≠nh 
                to√†n v·∫πn c·ªßa th√¥ng ƒëi·ªáp, t∆∞∆°ng t·ª± nh∆∞ ch·ªØ k√Ω tay nh∆∞ng b·∫±ng ph∆∞∆°ng ph√°p s·ªë.
            </p>

            <h4>Quy tr√¨nh t·∫°o ch·ªØ k√Ω:</h4>
            <ol>
                <li>T·∫°o hash c·ªßa th√¥ng ƒëi·ªáp</li>
                <li>M√£ h√≥a hash b·∫±ng Private Key (signing)</li>
                <li>G·ª≠i th√¥ng ƒëi·ªáp + ch·ªØ k√Ω</li>
            </ol>

            <h4>Quy tr√¨nh x√°c th·ª±c:</h4>
            <ol>
                <li>Nh·∫≠n th√¥ng ƒëi·ªáp + ch·ªØ k√Ω</li>
                <li>Gi·∫£i m√£ ch·ªØ k√Ω b·∫±ng Public Key ‚Üí hash1</li>
                <li>T√≠nh hash c·ªßa th√¥ng ƒëi·ªáp ‚Üí hash2</li>
                <li>So s√°nh hash1 v√† hash2</li>
            </ol>
        </section>

        <section class="interactive-demo">
            <h2>üéÆ Th·ª≠ nghi·ªám</h2>
            
            <h3>Hash Calculator</h3>
            <div class="demo-container">
                <div class="demo-group">
                    <label>Nh·∫≠p vƒÉn b·∫£n ƒë·ªÉ t√≠nh hash:</label>
                    <textarea id="hash-input" rows="3" placeholder="Nh·∫≠p vƒÉn b·∫£n..."></textarea>
                </div>
                <button class="demo-btn" onclick="calculateHash()">T√≠nh Hash (SHA-256)</button>
                <div id="hash-result" style="margin-top: 1rem; padding: 1rem; background: var(--border-dark); border-radius: 0.3rem;">
                    <strong>Hash:</strong> <span id="hash-output" style="font-family: monospace; word-break: break-all;"></span>
                </div>
            </div>

            <h3>Hash Collision Demo</h3>
            <div class="demo-container">
                <p>Th·ª≠ t√¨m 2 vƒÉn b·∫£n kh√°c nhau c√≥ c√πng hash (r·∫•t kh√≥!):</p>
                <div class="demo-group">
                    <label>VƒÉn b·∫£n 1:</label>
                    <input type="text" id="collision-input1" placeholder="Text 1...">
                </div>
                <div class="demo-group">
                    <label>VƒÉn b·∫£n 2:</label>
                    <input type="text" id="collision-input2" placeholder="Text 2...">
                </div>
                <button class="demo-btn" onclick="checkCollision()">Ki·ªÉm tra Collision</button>
                <div id="collision-result" style="margin-top: 1rem;"></div>
            </div>

            <h3>Digital Signature Demo</h3>
            <div class="demo-container">
                <div class="demo-group">
                    <label>Th√¥ng ƒëi·ªáp:</label>
                    <textarea id="sign-message" rows="2" placeholder="Nh·∫≠p th√¥ng ƒëi·ªáp..."></textarea>
                </div>
                <button class="demo-btn" onclick="createSignature()">T·∫°o ch·ªØ k√Ω</button>
                <div id="signature-result" style="margin-top: 1rem;">
                    <p><strong>Ch·ªØ k√Ω:</strong> <span id="signature-output" style="font-family: monospace; word-break: break-all;"></span></p>
                    <button class="demo-btn" onclick="verifySignature()">X√°c th·ª±c ch·ªØ k√Ω</button>
                    <p id="verification-result" style="margin-top: 0.5rem;"></p>
                </div>
            </div>
        </section>

        <section class="quiz">
            <h2>üìù Ki·ªÉm tra ki·∫øn th·ª©c</h2>
            <div class="quiz-questions"></div>
            <button class="quiz-submit">N·ªôp b√†i</button>
            <div class="quiz-score"></div>
        </section>
    </main>

    <footer class="lesson-footer">
        <button class="btn-prev" onclick="window.location.href='lesson-09-asymmetric.html'">‚Üê B√†i tr∆∞·ªõc</button>
        <button class="btn-next" onclick="window.location.href='lesson-11-applications.html'">B√†i ti·∫øp theo ‚Üí</button>
    </footer>

    <script src="../js/crypt-util.js"></script>
    <script src="../js/lesson-core.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.js"></script>
    <script>
        LessonCore.currentLesson = 10;
        LessonCore.updateLessonProgressBar();
        QuizSystem.init(10);

        let storedSignature = null;
        let storedMessage = null;

        function calculateHash() {
            const input = document.getElementById('hash-input').value;
            if (!input) return;

            // Simple hash simulation (in real app, use Web Crypto API or library)
            const hash = CryptoJS.SHA256(input).toString();
            document.getElementById('hash-output').textContent = hash;
        }

        function checkCollision() {
            const text1 = document.getElementById('collision-input1').value;
            const text2 = document.getElementById('collision-input2').value;

            if (!text1 || !text2) {
                document.getElementById('collision-result').innerHTML = 
                    '<p style="color: red;">Vui l√≤ng nh·∫≠p c·∫£ 2 vƒÉn b·∫£n!</p>';
                return;
            }

            const hash1 = CryptoJS.SHA256(text1).toString();
            const hash2 = CryptoJS.SHA256(text2).toString();

            const result = document.getElementById('collision-result');
            if (hash1 === hash2) {
                result.innerHTML = `<p style="color: green;">üéâ T√¨m th·∫•y collision! Hash: ${hash1}</p>`;
            } else {
                result.innerHTML = `
                    <p>Hash 1: <code>${hash1}</code></p>
                    <p>Hash 2: <code>${hash2}</code></p>
                    <p style="color: orange;">Kh√¥ng ph·∫£i collision. H√£y th·ª≠ l·∫°i!</p>
                `;
            }
        }

        function createSignature() {
            const message = document.getElementById('sign-message').value;
            if (!message) return;

            // Simulate signing: hash the message
            const signature = CryptoJS.SHA256(message + 'SECRET_KEY').toString();
            storedSignature = signature;
            storedMessage = message;

            document.getElementById('signature-output').textContent = signature;
            document.getElementById('verification-result').innerHTML = '';
        }

        function verifySignature() {
            const message = document.getElementById('sign-message').value;
            if (!message || !storedSignature) {
                document.getElementById('verification-result').innerHTML = 
                    '<p style="color: red;">Ch∆∞a c√≥ ch·ªØ k√Ω ho·∫∑c th√¥ng ƒëi·ªáp!</p>';
                return;
            }

            const expectedSignature = CryptoJS.SHA256(message + 'SECRET_KEY').toString();
            const isValid = expectedSignature === storedSignature && message === storedMessage;

            const result = document.getElementById('verification-result');
            if (isValid) {
                result.innerHTML = '<p style="color: green;">‚úì Ch·ªØ k√Ω h·ª£p l·ªá! Th√¥ng ƒëi·ªáp ch∆∞a b·ªã thay ƒë·ªïi.</p>';
            } else {
                result.innerHTML = '<p style="color: red;">‚úó Ch·ªØ k√Ω kh√¥ng h·ª£p l·ªá! Th√¥ng ƒëi·ªáp c√≥ th·ªÉ ƒë√£ b·ªã thay ƒë·ªïi.</p>';
            }
        }

        const originalCheck = QuizSystem.checkAnswers.bind(QuizSystem);
        QuizSystem.checkAnswers = function() {
            const score = originalCheck();
            if (score >= 70) {
                LessonCore.markLessonComplete(10, score);
            }
        };
    </script>
</body>
</html>

