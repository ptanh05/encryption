<!doctype html>
<html lang="vi">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>B√†i 7: Cryptanalysis Techniques</title>
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/fontello.css">
    <link rel="stylesheet" href="../css/design-system.css">
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/lesson-styles.css">
    <link rel="stylesheet" href="../css/animations.css">
    <link rel="stylesheet" href="../css/responsive.css">
</head>
<body class="lesson" data-lesson="7">
    <nav class="lesson-nav">
        <a href="../index.html">‚Üê V·ªÅ trang ch·ªß</a>
        <div class="lesson-progress-bar">
            <div class="progress-fill"></div>
        </div>
    </nav>

    <header class="lesson-header">
        <h1>B√†i 7: Cryptanalysis Techniques</h1>
        <p class="lesson-meta">
            <span>‚è±Ô∏è Th·ªùi gian: ~35 ph√∫t</span>
            <span>‚≠ê ƒê·ªô kh√≥: Kh√≥</span>
            <span>üìö Module 3: Ph√¢n t√≠ch v√† T·∫•n c√¥ng</span>
        </p>
    </header>

    <main class="lesson-content">
        <section class="theory">
            <h2>üìñ L√Ω thuy·∫øt</h2>
            
            <h3>C√°c lo·∫°i t·∫•n c√¥ng</h3>
            
            <h4>1. Ciphertext-Only Attack</h4>
            <p>
                K·∫ª t·∫•n c√¥ng ch·ªâ c√≥ ciphertext, kh√¥ng c√≥ plaintext hay key. ƒê√¢y l√† t√¨nh hu·ªëng kh√≥ nh·∫•t.
            </p>
            <div class="example-box">
                <strong>K·ªπ thu·∫≠t:</strong> Frequency analysis, pattern recognition, brute force
            </div>

            <h4>2. Known Plaintext Attack</h4>
            <p>
                K·∫ª t·∫•n c√¥ng c√≥ c·∫£ plaintext v√† ciphertext t∆∞∆°ng ·ª©ng. M·ª•c ti√™u l√† t√¨m key.
            </p>
            <div class="example-box">
                <strong>V√≠ d·ª•:</strong> Bi·∫øt "HELLO" ‚Üí "KHOOR", c√≥ th·ªÉ suy ra shift = 3
            </div>

            <h4>3. Chosen Plaintext Attack</h4>
            <p>
                K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch·ªçn plaintext v√† nh·∫≠n ciphertext t∆∞∆°ng ·ª©ng.
            </p>

            <h4>4. Side-Channel Attack</h4>
            <p>
                T·∫•n c√¥ng d·ª±a tr√™n th√¥ng tin ph·ª• nh∆∞ th·ªùi gian th·ª±c thi, ti√™u th·ª• nƒÉng l∆∞·ª£ng, 
                ho·∫∑c b·ª©c x·∫° ƒëi·ªán t·ª´.
            </p>

            <h3>Kasiski Examination</h3>
            <p>
                K·ªπ thu·∫≠t t√¨m ƒë·ªô d√†i key c·ªßa Vigen√®re Cipher b·∫±ng c√°ch:
            </p>
            <ol>
                <li>T√¨m c√°c chu·ªói l·∫∑p l·∫°i trong ciphertext</li>
                <li>T√≠nh kho·∫£ng c√°ch gi·ªØa c√°c chu·ªói l·∫∑p</li>
                <li>T√¨m ∆∞·ªõc chung l·ªõn nh·∫•t (GCD) c·ªßa c√°c kho·∫£ng c√°ch</li>
                <li>GCD c√≥ th·ªÉ l√† ƒë·ªô d√†i key</li>
            </ol>

            <h3>Brute Force Attack</h3>
            <p>
                Th·ª≠ t·∫•t c·∫£ c√°c kh·∫£ nƒÉng key cho ƒë·∫øn khi t√¨m ra plaintext c√≥ nghƒ©a.
            </p>
            <div class="example-box">
                <strong>Caesar Cipher:</strong> 26 kh·∫£ nƒÉng (kh·∫£ thi)
                <br><strong>AES-256:</strong> 2^256 kh·∫£ nƒÉng (kh√¥ng kh·∫£ thi v·ªõi c√¥ng ngh·ªá hi·ªán t·∫°i)
            </div>
        </section>

        <section class="interactive-demo">
            <h2>üéÆ Th·ª≠ nghi·ªám</h2>
            
            <h3>Known Plaintext Attack Simulator</h3>
            <div class="demo-container">
                <div class="demo-group">
                    <label>Known Plaintext:</label>
                    <input type="text" id="known-plaintext" placeholder="HELLO">
                </div>
                <div class="demo-group">
                    <label>Known Ciphertext:</label>
                    <input type="text" id="known-ciphertext" placeholder="KHOOR">
                </div>
                <button class="demo-btn" onclick="findKey()">T√¨m Key</button>
                <div id="key-result" style="margin-top: 1rem;"></div>
            </div>

            <h3>Kasiski Examination</h3>
            <div class="demo-container">
                <div class="demo-group">
                    <label>Ciphertext (Vigen√®re):</label>
                    <textarea id="kasiski-input" rows="3" 
                              placeholder="Nh·∫≠p ciphertext..."></textarea>
                </div>
                <button class="demo-btn" onclick="kasiskiExamination()">Ph√¢n t√≠ch</button>
                <div id="kasiski-results" style="margin-top: 1rem;"></div>
            </div>
        </section>

        <section class="quiz">
            <h2>üìù Ki·ªÉm tra ki·∫øn th·ª©c</h2>
            <div class="quiz-questions"></div>
            <button class="quiz-submit">N·ªôp b√†i</button>
            <div class="quiz-score"></div>
        </section>
    </main>

    <footer class="lesson-footer">
        <button class="btn-prev" onclick="window.location.href='lesson-06-frequency-analysis.html'">‚Üê B√†i tr∆∞·ªõc</button>
        <button class="btn-next" onclick="window.location.href='lesson-08-symmetric.html'">B√†i ti·∫øp theo ‚Üí</button>
    </footer>

    <script src="../js/crypt-util.js"></script>
    <script src="../js/lesson-core.js"></script>
    <script>
        LessonCore.currentLesson = 7;
        LessonCore.updateLessonProgressBar();
        QuizSystem.init(7);

        function findKey() {
            const plaintext = document.getElementById('known-plaintext').value.toUpperCase();
            const ciphertext = document.getElementById('known-ciphertext').value.toUpperCase();
            
            if (plaintext.length !== ciphertext.length) {
                document.getElementById('key-result').innerHTML = 
                    '<p style="color: red;">Plaintext v√† Ciphertext ph·∫£i c√≥ c√πng ƒë·ªô d√†i!</p>';
                return;
            }

            // Find shift for Caesar
            let shifts = [];
            for (let i = 0; i < plaintext.length; i++) {
                if (plaintext[i] >= 'A' && plaintext[i] <= 'Z' && 
                    ciphertext[i] >= 'A' && ciphertext[i] <= 'Z') {
                    const shift = (ciphertext.charCodeAt(i) - plaintext.charCodeAt(i) + 26) % 26;
                    shifts.push(shift);
                }
            }

            if (shifts.length > 0) {
                const mostCommonShift = shifts.sort((a,b) =>
                    shifts.filter(v => v===a).length - shifts.filter(v => v===b).length
                ).pop();
                
                document.getElementById('key-result').innerHTML = 
                    `<strong>Key (Caesar Shift):</strong> ${mostCommonShift}`;
            }
        }

        function kasiskiExamination() {
            const ciphertext = document.getElementById('kasiski-input').value.toUpperCase();
            if (!ciphertext) return;

            // Find repeating patterns
            const patterns = {};
            for (let len = 3; len <= 5; len++) {
                for (let i = 0; i <= ciphertext.length - len; i++) {
                    const pattern = ciphertext.substr(i, len);
                    if (!patterns[pattern]) {
                        patterns[pattern] = [];
                    }
                    patterns[pattern].push(i);
                }
            }

            // Find patterns that appear multiple times
            const repeating = {};
            for (let pattern in patterns) {
                if (patterns[pattern].length > 1) {
                    repeating[pattern] = patterns[pattern];
                }
            }

            let result = '<h4>Chu·ªói l·∫∑p l·∫°i:</h4><ul>';
            const distances = [];
            
            for (let pattern in repeating) {
                const positions = repeating[pattern];
                result += `<li><strong>${pattern}</strong>: V·ªã tr√≠ ${positions.join(', ')}</li>`;
                
                for (let i = 1; i < positions.length; i++) {
                    distances.push(positions[i] - positions[0]);
                }
            }
            result += '</ul>';

            if (distances.length > 0) {
                // Find GCD
                const gcd = distances.reduce((a, b) => {
                    while (b) {
                        const t = b;
                        b = a % b;
                        a = t;
                    }
                    return a;
                });

                result += `<h4>Kho·∫£ng c√°ch:</h4><p>${distances.join(', ')}</p>`;
                result += `<h4>∆Ø·ªõc chung l·ªõn nh·∫•t:</h4><p><strong>${gcd}</strong> (c√≥ th·ªÉ l√† ƒë·ªô d√†i key)</p>`;
            }

            document.getElementById('kasiski-results').innerHTML = result;
        }

        const originalCheck = QuizSystem.checkAnswers.bind(QuizSystem);
        QuizSystem.checkAnswers = function() {
            const score = originalCheck();
            if (score >= 70) {
                LessonCore.markLessonComplete(7, score);
            }
        };
    </script>
</body>
</html>

